# ğŸ¬ LatentSync â€“ Super-Resolution Enhancement (GFPGAN + CodeFormer)

This project enhances the **LatentSync lip-sync output video** quality using two AI-based **super-resolution models** â€” **GFPGAN** and **CodeFormer**.  
The enhancement focuses only on the **mouth region** generated by LatentSync to restore fine facial details while maintaining full-frame performance.  

---

## ğŸ“š Project Summary

- Original LatentSync output (`lipsynced.mp4`) had **blurred or low-resolution mouth regions** after lip-syncing.  
- I integrated **super-resolution models** into the LatentSync pipeline (`inference.py`).  
- Added a new argument:
  ```bash
  --superres [GFPGAN | CodeFormer]
which allows switching between the two enhancement frameworks.

The code detects the low-resolution region dynamically and applies enhancement only where necessary to save computation.

âš™ï¸ Installation

git clone https://github.com/<yourusername>/LatentSync.git
cd LatentSync
pip install -r requirements.txt
ğŸ§© Dependencies
nginx
Copy code
torch
torchvision
numpy
opencv-python
facexlib
basicsr
gfpgan
tqdm
ffmpeg-python

ğŸ“¦ Pretrained Models
Model	Path	Download Link
GFPGANv1.4.pth	GFPGAN/experiments/pretrained_models/	GFPGAN v1.4
codeformer.pth	CodeFormer/weights/	CodeFormer v0.1

ğŸš€ How to Run
ğŸ§  GFPGAN Mode
python inference.py --input input_video_with_audio.mp4 --output output_GFPGAN_Final.mp4 --superres GFPGAN
ğŸ§  CodeFormer Mode
python inference.py --input input_video_with_audio.mp4 --output output_CodeFormer_final.mp4 --superres CodeFormer
ğŸ“Š Example Outputs
Type	Description
Input	Original lipsynced.mp4 (blurry mouth region)
GFPGAN Output	Sharper, cleaner details
CodeFormer Output	Fine facial restoration, color-consistent results

Google Drive (Models + Outputs):
ğŸ”— https://drive.google.com/drive/folders/1cPYHe6GNPAXR75eVMDJiEx8Hw1eIAP0T?usp=sharing

ğŸ§  Improvement Summary
Feature	Description
--superres Argument	Choose between GFPGAN or CodeFormer
Conditional Enhancement	Applies only to low-resolution regions
GPU Acceleration	Uses CUDA automatically
Error Handling	Skips invalid or empty frames safely
Speed Mode	Efficient region processing, not full-frame

ğŸ§© Flowchart of Pipeline
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Input Video (LipSynced) â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ Extract Mouth ROI â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                      Resolution Check
                (compare ROI size vs frame)
                               â”‚
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                                 â”‚
             â–¼                                 â–¼
      ROI Quality Poor?                ROI Quality Good?
             â”‚                                 â”‚
             â–¼                                 â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Apply Super-Resolutionâ”‚            â”‚ Keep Original Region â”‚
 â”‚ (GFPGAN / CodeFormer) â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Merge ROI into Full Frameâ”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Save Enhanced Output.mp4 â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     
ğŸ“ Folder Explanation
Folder	Description
/GFPGAN	GFPGAN model architecture and pretrained weights
/CodeFormer	CodeFormer model, includes basicsr library
/output_CodeFormer_fixed/	Restored faces, cropped regions, and final results
/sample_output/	Optional short before/after demo clips

ğŸ“š Credits
LatentSync Original Repository

GFPGAN by TencentARC

CodeFormer by sczhou

âœ… Submission Summary
